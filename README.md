# 🥗 SSAIET

### 점심 선택 기반 개인 맞춤 저녁 추천 & 식단 관리 서비스

> 점심 한 끼 선택으로 오늘 하루의 식단 균형을 완성하다

---

## 👥 팀원 소개 및 역할

### 👑 팀장 | 황가연

**역할**

- GPT API 연동 및 프롬프트 설계
- 점심(Meal) · 저녁(Dinner) 도메인 FE · BE 구현
- PyTorch 기반 딥러닝 회귀 모델 개발
  - 체중 변화 예측
  - Rule-based → ML 전환 구조 설계

---

### 👤 팀원 | 진준영

**역할**

- Kakao Map API 연동 (주변 식당 탐색)
- Account / Community / Calendar 도메인 FE · BE 구현
- 인증, 게시글, 식단 기록 전체 사용자 흐름 설계 및 구현
- JWT 인증 · 권한 구조 설계

---

## 1. 프로젝트 개요

- **프로젝트명**: SSAIET
- **서비스 성격**: 개인 맞춤 식단 관리 / 헬스케어 서비스
- **핵심 키워드**
  - 점심 선택 기반 추천
  - JWT 인증 & 권한 설계
  - 서버 중심 설계
  - 확장 가능한 데이터 구조

---

## 2. 기획 의도

- 회사 점심은 선택지가 명확하지만 저녁은 항상 고민
- 단순 메뉴 추천이 아닌**“오늘 내가 먹은 점심 + 내 몸 상태 + 목표”**를 반영한 추천 필요
- 선택 데이터를 축적해 **개인화와 확장**이 가능한 구조를 목표로 설계

---

## 3. 프로젝트 소개

- 멀티캠퍼스(20층) 식단 API 연동
- 사용자가 점심 메뉴를 선택하면:
  - 섭취한 영양 성분 분석
  - 남은 권장 칼로리·단백질 계산
  - AI 기반 맞춤 저녁 식단 추천
- 모든 기록은 DB에 저장되어:
  - 월간 캘린더
  - 일일 영양 상세
  - 목표 체중 진척도 및 30일 후 예측 제공

---

## 4. 활용 방안

- 직장인 식단 관리 서비스
- 사내 복지 플랫폼 연계
- 헬스케어 / 다이어트 서비스 확장
- 운동 기록, 웨어러블 데이터 연동 가능

---

## 5. 주요 기능

### 🍱 점심 식단 제공

- 멀티캠퍼스 식단 API 호출
- 메뉴 사진, 영양 정보, P-Score 제공
- 카드 UI 기반 직관적 선택

### 🍽 점심 선택 → 저녁 추천

- 점심 영양 기반 잔여 영양 계산
- 목표에 맞는 저녁 메뉴 자동 추천
- 추천 이유 및 예상 영양 제공

### 📊 식단 기록 & 통계

- 점심·저녁 식단 DB 저장
- 월간 캘린더 조회
- 일일 상세 영양 정보 제공

### 🎯 목표 관리 & 예측

- 목표 체중 대비 진척도 시각화
- 30일 후 체중 변화 예측
- Cold Start 대응 Rule-based 모델 적용

### 🗺 주변 식당 탐색

- Kakao Map API 연동
- 현재 위치 기준 주변 식당 조회
- 건강 태그 기반 식당 탐색

### 💬 커뮤니티

- 식당 추천 / 변화 후기 / Q&A / 자유 게시판
- 좋아요·댓글 기능
- SPA 환경에서도 안정적인 단건 조회 구조

---

## 6. 기술 스택

### Backend

- Python
- Django
- Django REST Framework
- JWT (SimpleJWT)
- SQLite (개발 단계)

### Frontend

- Vue.js
- Pinia
- SPA 구조

### AI / Data

- GPT 기반 저녁 추천
- PyTorch 기반 회귀 모델
- 영양 공식 기반 합성 데이터
- Rule-based → 실데이터 전환 구조

---

## 7. 기능 화면

### 🔐 로그인 / 회원가입

| 로그인                  | 회원가입                  |
| ----------------------- | ------------------------- |
| ![login](./pic/login.png) | ![signup](./pic/signup.png) |

---

### 🏠 메인 페이지 (점심 메뉴)

| 메인                   | 점심 상세              |
| ---------------------- | ---------------------- |
| ![main1](./pic/main.png) | ![main2](./pic/meal.png) |

---

### 🍽 저녁 추천

| 추천 결과                  |
| -------------------------- |
| ![dinner1](./pic/dinner.png) |

---

### 📅 캘린더 & 기록

| 캘린더                          | 캘린더 상세                     |
| ------------------------------- | ------------------------------- |
| ![calendar1](./pic/calendar2.png) | ![calendar2](./pic/calendar1.png) |

---

### 🗺 주변 식당

| 지도 보기                  |
| -------------------------- |
| ![map1](./pic/nearstore.png) |

---

### ⚖ 체중 예측

| 진척도                     |
| -------------------------- |
| ![weight1](./pic/weight.png) |

---

### 💬 커뮤니티

| 게시글 목록                      |
| -------------------------------- |
| ![community1](./pic/community.png) |

---


## 8. 문제 해결 사례

### 1️⃣ JWT 인증이 있어도 다른 유저 요청이 가능했던 보안 취약점

**문제**

- request body로 user_id를 받아 처리
- Postman에서 user_id 변경 시 다른 유저 요청 가능 (IDOR)

**원인**

- Django 함수 뷰 + csrf_exempt
- 클라이언트 user_id 신뢰 구조

**해결**

- DRF 기반 API로 통일
- IsAuthenticated 적용
- user_id 제거, request.user만 사용
- (id, user) 조합으로 소유권 검증

**결과**

- 수평 권한 상승 취약점 차단
- 유저 식별은 서버 책임이라는 원칙 체득

---

### 2️⃣ token_not_valid 인증 오류 반복 발생

**원인**

- 토큰 발급 엔드포인트 혼용
- Authorization 헤더 형식 오류
- 서버 재시작 후 토큰 재사용

**해결**

- 토큰 발급 경로 단일화
- Bearer Token 규칙 통일
- 상태 코드 기반 디버깅

**결과**

- 인증 / 인가 / 서버 오류 분리 가능

---

### 3️⃣ f-string + JSON 중괄호로 인한 500 에러

**원인**

- f-string 내부 `{}`가 포맷 변수로 해석

**해결**

- JSON 중괄호 이스케이프 처리

**결과**

- AI 연동 오류의 다양한 원인에 대한 경험 확보

---

### 4️⃣ SQLite 마이그레이션 fromisoformat 에러

**원인**

- nullable=False 필드 추가
- auto_now_add 변경
- SQLite ALTER TABLE 제한

**해결**

- 개발 단계: DB 재생성
- 운영 고려: 2-step migration 전략

**결과**

- 마이그레이션은 히스토리 관리라는 인식 정립

---

### 5️⃣ 추천 로직 개인화 실패 설계 문제

**원인**

- 유저 행동 데이터를 저장하는 레이어 부재

**해결**

- UserSelectedMeal 모델 도입
- 추천 입력을 user_selected_meal_id 기준으로 변경

**결과**

- 실제 유저 선택 이력 기반 추천 구현

---

### 6️⃣ SPA 딥링크 취약 문제

**문제**

- 새로고침 시 게시글 없음 오류

**해결**

- 단건 조회 API 추가
- 서버를 진실의 원천으로 설정

**결과**

- 공유 링크·새로고침 안정화

---

### 7️⃣ PATCH / PUT 혼용으로 인한 API 오류

**해결**

- PATCH 단일화
- 백엔드 partial=True
- 프론트 API 스펙 통일

**결과**

- 404 / 405 명확한 원인 분리 가능

---

### 8️⃣ 1일 1회 추천 정책 레이스 컨디션

**해결**

- (user, date) UniqueConstraint
- get_or_create() 사용

**결과**

- 비즈니스 룰을 DB가 보장

---

### 9️⃣ 데이터 부족으로 인한 ML Cold Start 문제

**해결**

- 영양 공식 기반 합성 데이터 생성
- Rule-based Labeling 적용

**결과**

- 실데이터 유입 전에도 예측 기능 제공 가능

---

## 9. 성과

- JWT 인증 + 권한 검증 설계 경험
- DB 제약 조건을 활용한 정책 보장
- 서버 중심 SPA 설계
- AI 연동 및 에러 디버깅 경험
- 확장 가능한 추천 구조 설계

---

## 10. 느낀 점

- 인증은 로그인 문제가 아니라 권한 설계 문제
- 상태는 캐시, 진실의 원천은 서버
- 비즈니스 룰은 코드보다 DB가 강하다
- 작은 설계 차이가 개인화 품질을 결정한다

---

## 🚀 향후 확장

- 아침·저녁 자동 추천
- 개인별 식단 패턴 학습
- 운동 기록 연계
- 알레르기 자동 필터링 고도화
